(function(b){"function"===typeof define&&define.amd?define("jquery ./grid.base jquery-ui/dialog jquery-ui/draggable jquery-ui/droppable jquery-ui/resizable jquery-ui/sortable".split(" "),b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var q=b.jgrid,u=q.jqID,l=null!=b.ui?b.ui.multiselect:null;q.msie&&8===q.msiever()&&(b.expr[":"].hidden=function(b){return 0===b.offsetWidth||0===b.offsetHeight||"none"===b.style.display});q._multiselect=!1;if(l){if(l.prototype._setSelected){var C=
l.prototype._setSelected;l.prototype._setSelected=function(a,h){var e=C.call(this,a,h),d=this.element;h&&this.selectedList&&this.selectedList.find("li").each(function(){b(this).data("optionLink")&&b(this).data("optionLink").remove().appendTo(d)});return e}}l.prototype.destroy&&(l.prototype.destroy=function(){this.element.show();this.container.remove();void 0===b.Widget?b.widget.prototype.destroy.apply(this,arguments):b.Widget.prototype.destroy.apply(this,arguments)});q._multiselect=!0}q.extend({sortableColumns:function(a){return this.each(function(){function h(){d.disableClick=
!0}var e=this,d=e.p,c=u(d.id),c={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+c+"_cb,#jqgh_"+c+"_rn,#jqgh_"+c+"_subgrid),:hidden)",placeholder:{element:function(a){return b(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(b,a){a.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||
0,10));a.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}},update:function(a,c){var k=b(">th",b(c.item).parent()),g=d.id+"_",h=[];k.each(function(){var a=b(">div",this).get(0).id.replace(/^jqgh_/,"").replace(g,""),a=d.iColByName[a];void 0!==a&&h.push(a)});b(e).jqGrid("remapColumns",h,!0,!0);b.isFunction(d.sortable.update)&&d.sortable.update(h);setTimeout(function(){d.disableClick=!1},50)}};d.sortable.options?b.extend(c,
d.sortable.options):b.isFunction(d.sortable)&&(d.sortable={update:d.sortable});if(c.start){var k=c.start;c.start=function(b,a){h();k.call(this,b,a)}}else c.start=h;d.sortable.exclude&&(c.items+=":not("+d.sortable.exclude+")");c=a.sortable(c);c=c.data("sortable")||c.data("uiSortable")||c.data("ui-sortable");null!=c&&(c.floating=!0)})},columnChooser:function(a){function h(a,c){a&&("string"===typeof a?b.fn[a]&&b.fn[a].apply(c,b.makeArray(arguments).slice(2)):b.isFunction(a)&&a.apply(c,b.makeArray(arguments).slice(2)))}
var e=this,d=e[0],c=d.p,k,m,x={},f=[],g,t,n=c.colModel;g=n.length;t=c.colNames;var A=function(b){return l&&l.prototype&&b.data(l.prototype.widgetFullName||l.prototype.widgetName)||b.data("ui-multiselect")||b.data("multiselect")};if(!b("#colchooser_"+u(c.id)).length){k=b('<div id="colchooser_'+c.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');m=b("select",k);a=b.extend({width:400,height:240,classname:null,done:function(b){b&&null==c.groupHeader&&
e.jqGrid("remapColumns",b,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(a){var c={};c[a.bSubmit]=function(){a.apply_perm();a.cleanup(!1)};c[a.bCancel]=function(){a.cleanup(!0)};return b.extend(!0,{buttons:c,close:function(){a.cleanup(!0)},modal:a.modal||!1,resizable:a.resizable||!0,width:a.width+70,resize:function(){var b=A(m),a=b.container.closest(".ui-dialog-content");0<a.length&&"object"===typeof a[0].style?a[0].style.width="":a.css("width",
"");b.selectedList.height(Math.max(b.selectedContainer.height()-b.selectedActions.outerHeight()-1,1));b.availableList.height(Math.max(b.availableContainer.height()-b.availableActions.outerHeight()-1,1))}},a.dialog_opts||{})},apply_perm:function(){var k=[],d={notSkipFrozen:void 0===a.notSkipFrozen?!1:a.notSkipFrozen,skipSetGridWidth:!0,skipSetGroupHeaders:!0};b("option",m).each(function(){b(this).is(":selected")?e.jqGrid("showCol",n[this.value].name,d):e.jqGrid("hideCol",n[this.value].name,d)});if(c.groupHeader&&
("object"===typeof c.groupHeader||b.isFunction(c.groupHeader)))if(e.jqGrid("destroyGroupHeader",!1),null!=c.pivotOptions&&null!=c.pivotOptions.colHeaders&&1<c.pivotOptions.colHeaders.length){var f,g=c.pivotOptions.colHeaders;for(f=0;f<g.length;f++)g[f]&&g[f].groupHeaders.length&&e.jqGrid("setGroupHeaders",g[f])}else e.jqGrid("setGroupHeaders",c.groupHeader);b("option",m).filter(":selected").each(function(){k.push(parseInt(this.value,10))});b.each(k,function(){delete x[n[parseInt(this,10)].name]});
b.each(x,function(){var b=parseInt(this,10);var a=k,c=b,e,f;0<=c?(e=a.slice(),f=e.splice(c,Math.max(a.length-c,c)),c>a.length&&(c=a.length),e[c]=b,k=e.concat(f)):k=a});a.done&&a.done.call(e,k);e.jqGrid("setGridWidth",c.autowidth||void 0!==c.widthOrg&&"auto"!==c.widthOrg&&"100%"!==c.widthOrg?c.width:c.tblwidth,c.shrinkToFit)},cleanup:function(b){h(a.dlog,k,"destroy");h(a.msel,m,"destroy");k.remove();b&&a.done&&a.done.call(e)},msel_opts:{}},e.jqGrid("getGridRes","col"),q.col,a||{});if(b.ui&&l&&l.defaults){if(!q._multiselect){(null!=
q.defaults&&b.isFunction(q.defaults.fatalError)?q.defaults.fatalError:alert)("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}a.msel_opts=b.extend(l.defaults,a.msel_opts)}a.caption&&k.attr("title",a.caption);a.classname&&(k.addClass(a.classname),m.addClass(a.classname));a.width&&(b(">div",k).css({width:a.width,margin:"0 auto"}),m.css("width",a.width));a.height&&(b(">div",k).css("height",a.height),m.css("height",a.height-10));m.empty();var y=c.groupHeader,
r={},v,z,B,p,w;if(null!=y&&null!=y.groupHeaders)for(v=0,B=y.groupHeaders.length;v<B;v++)for(w=y.groupHeaders[v],z=0;z<w.numberOfColumns;z++)p=c.iColByName[w.startColumnName]+z,r[p]=b.isFunction(a.buildItemText)?a.buildItemText.call(e[0],{iCol:p,cm:n[p],cmName:n[p].name,colName:t[p],groupTitleText:w.titleText}):b.jgrid.stripHtml(w.titleText)+": "+b.jgrid.stripHtml(""===t[p]?n[p].name:t[p]);for(p=0;p<g;p++)void 0===r[p]&&(r[p]=b.isFunction(a.buildItemText)?a.buildItemText.call(e[0],{iCol:p,cm:n[p],
cmName:n[p].name,colName:t[p],groupTitleText:null}):b.jgrid.stripHtml(t[p]));b.each(n,function(b){x[this.name]=b;this.hidedlg?this.hidden||f.push(b):m.append("<option value='"+b+"'"+(c.headertitles||this.headerTitle?" title='"+q.stripHtml("string"===typeof this.headerTitle?this.headerTitle:r[b])+"'":"")+(this.hidden?"":" selected='selected'")+">"+r[b]+"</option>")});g=b.isFunction(a.dlog_opts)?a.dlog_opts.call(e,a):a.dlog_opts;h(a.dlog,k,g);g=b.isFunction(a.msel_opts)?a.msel_opts.call(e,a):a.msel_opts;
h(a.msel,m,g);g=b("#colchooser_"+u(c.id));g.css({margin:"auto"});g.find(">div").css({width:"100%",height:"100%",margin:"auto"});if(g=A(m))g.container.css({width:"100%",height:"100%",margin:"auto"}),g.selectedContainer.css({width:100*g.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),g.availableContainer.css({width:100-100*g.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"}),g.selectedList.css("height","auto"),g.availableList.css("height",
"auto"),t=Math.max(g.selectedList.height(),g.availableList.height()),t=Math.min(t,b(window).height()),g.selectedList.css("height",t),g.availableList.css("height",t),null!=g.options&&g.options.sortable&&g.selectedList.bind("sortupdate",function(c,k){k.item.css({width:"",height:""});b.isFunction(a.sortUpdate)&&a.sortUpdate.call(d,c,k)}),b.isFunction(a.init)&&a.init.call(d,g)}},sortableRows:function(a){return this.each(function(){var h=this,e=h.grid,d=h.p;e&&!d.treeGrid&&b.fn.sortable&&(a=b.extend({cursor:"move",
axis:"y",items:">tbody>.jqgrow"},a||{}),a.start&&b.isFunction(a.start)?(a._start_=a.start,delete a.start):a._start_=!1,a.update&&b.isFunction(a.update)?(a._update_=a.update,delete a.update):a._update_=!1,a.start=function(c,k){b(k.item).css("border-width","0");b("td",k.item).each(function(b){this.style.width=e.cols[b].style.width});if(d.subGrid){var m=b(k.item).attr("id");try{b(h).jqGrid("collapseSubGridRow",m)}catch(x){}}a._start_&&a._start_.apply(this,[c,k])},a.update=function(c,k){b(k.item).css("border-width",
"");!0===d.rownumbers&&b("td.jqgrid-rownum",h.rows).each(function(a){b(this).html(a+1+(parseInt(d.page,10)-1)*parseInt(d.rowNum,10))});a._update_&&a._update_.apply(this,[c,k])},b(h).sortable(a),b.isFunction(b.fn.disableSelection)&&b(h.tBodies[0]).children("tr.jqgrow").disableSelection())})},gridDnD:function(a){return this.each(function(){function h(){var a=b.data(e,"dnd");b("tr.jqgrow:not(.ui-draggable)",e).draggable(b.isFunction(a.drag)?a.drag.call(b(e),a):a.drag)}var e=this,d,c;if(e.grid&&!e.p.treeGrid&&
b.fn.draggable&&b.fn.droppable)if(void 0===b("#jqgrid_dnd")[0]&&b("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>"),"string"===typeof a&&"updateDnD"===a&&!0===e.p.jqgdnd)h();else if(a=b.extend({drag:function(a){return b.extend({start:function(c,d){var f;if(e.p.subGrid){f=b(d.helper).attr("id");try{b(e).jqGrid("collapseSubGridRow",f)}catch(g){}}for(f=0;f<b.data(e,"dnd").connectWith.length;f++)0===b(b.data(e,"dnd").connectWith[f]).jqGrid("getGridParam","reccount")&&b(b.data(e,
"dnd").connectWith[f]).jqGrid("addRowData","jqg_empty_row",{});d.helper.addClass("ui-state-highlight");b("td",d.helper).each(function(b){this.style.width=e.grid.headers[b].width+"px"});a.onstart&&b.isFunction(a.onstart)&&a.onstart.call(b(e),c,d)},stop:function(c,d){var f;d.helper.dropped&&!a.dragcopy&&(f=b(d.helper).attr("id"),void 0===f&&(f=b(this).attr("id")),b(e).jqGrid("delRowData",f));for(f=0;f<b.data(e,"dnd").connectWith.length;f++)b(b.data(e,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row");
a.onstop&&b.isFunction(a.onstop)&&a.onstop.call(b(e),c,d)}},a.drag_opts||{})},drop:function(a){return b.extend({accept:function(a){if(!b(a).hasClass("jqgrow"))return a;a=b(a).closest("table.ui-jqgrid-btable");return 0<a.length&&void 0!==b.data(a[0],"dnd")?(a=b.data(a[0],"dnd").connectWith,-1!==b.inArray("#"+u(this.id),a)?!0:!1):!1},drop:function(c,d){if(b(d.draggable).hasClass("jqgrow")){var f=b(d.draggable).attr("id"),f=d.draggable.parent().parent().jqGrid("getRowData",f);if(!a.dropbyname){var g=
0,h={},n,l,q=b("#"+u(this.id)).jqGrid("getGridParam","colModel");try{for(l in f)f.hasOwnProperty(l)&&(n=q[g].name,"cb"!==n&&"rn"!==n&&"subgrid"!==n&&f.hasOwnProperty(l)&&q[g]&&(h[n]=f[l]),g++);f=h}catch(v){}}d.helper.dropped=!0;a.beforedrop&&b.isFunction(a.beforedrop)&&(n=a.beforedrop.call(this,c,d,f,b("#"+u(e.p.id)),b(this)),void 0!==n&&null!==n&&"object"===typeof n&&(f=n));if(d.helper.dropped){var r;a.autoid&&(b.isFunction(a.autoid)?r=a.autoid.call(this,f):(r=Math.ceil(1E3*Math.random()),r=a.autoidprefix+
r));b("#"+u(this.id)).jqGrid("addRowData",r,f,a.droppos);f[e.p.localReader.id]=r}a.ondrop&&b.isFunction(a.ondrop)&&a.ondrop.call(this,c,d,f)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},a||{}),a.connectWith)for(a.connectWith=a.connectWith.split(","),a.connectWith=b.map(a.connectWith,function(a){return b.trim(a)}),
b.data(e,"dnd",a),0===e.p.reccount||e.p.jqgdnd||h(),e.p.jqgdnd=!0,d=0;d<a.connectWith.length;d++)c=a.connectWith[d],b(c).droppable(b.isFunction(a.drop)?a.drop.call(b(e),a):a.drop)})},gridResize:function(a){return this.each(function(){var h=this,e=h.grid,d=h.p,c=d.gView+">.ui-jqgrid-bdiv",k=!1,m,l=d.height;if(e&&b.fn.resizable){a=b.extend({},a||{});a.alsoResize?(a._alsoResize_=a.alsoResize,delete a.alsoResize):a._alsoResize_=!1;a.stop&&b.isFunction(a.stop)?(a._stop_=a.stop,delete a.stop):a._stop_=
!1;a.stop=function(f,q){b(h).jqGrid("setGridWidth",q.size.width,a.shrinkToFit);b(d.gView+">.ui-jqgrid-titlebar").css("width","");k?(b(m).each(function(){b(this).css("height","")}),"auto"!==l&&"100%"!==l||b(e.bDiv).css("height",l)):b(h).jqGrid("setGridParam",{height:b(c).height()});h.fixScrollOffsetAndhBoxPadding&&h.fixScrollOffsetAndhBoxPadding();a._stop_&&a._stop_.call(h,f,q)};m=c;"auto"!==l&&"100%"!==l||void 0!==a.handles||(a.handles="e,w");if(a.handles){var f=b.map(String(a.handles).split(","),
function(a){return b.trim(a)});2===f.length&&("e"===f[0]&&"w"===f[1]||"e"===f[1]&&"w"===f[1])&&(m=d.gView+">div:not(.frozen-div)",k=!0,d.pager&&(m+=","+d.pager))}a.alsoResize=a._alsoResize_?m+","+a._alsoResize_:m;delete a._alsoResize_;b(d.gBox).resizable(a)}})}})});
//# sourceMappingURL=grid.jqueryui.map
